#!/usr/bin/env bash

header "package"

#-- Check for flags --------------------------------------------------------------------------------
if is_set "NO_PACKAGES"; then
  skip "Installing packages..."
  exit_header && return
fi

logl "Installing packages..."

#-- Utilities --------------------------------------------------------------------------------------
load_package () {
  sleep 0.05
  source "${DOTFILES_DIR}/packages/$1"
}
package_group () {
  subheader "$1"
  shift

  for item in "$@"; do
    package_install "$item"
  done

  exit_subheader
}
npm_group () {
  subheader "$1"
  shift

  for item in "$@"; do
    npm_install_global "$item"
  done

  exit_subheader
}

#-- Packages ---------------------------------------------------------------------------------------
package_install "wget"

# Bash additions
package_install "zopfli"
package_install "pigz"
package_install "screenfetch"

#-- Package Modules --------------------------------------------------------------------------------

# Browsers
load_package "chrome"

# Editors
load_package "emacs" \
  && command_exists "emacs" \
  && package_group "emacs-other" \
                   "adobe-source-code-pro-fonts" \
                   "aspell" \
                   "aspell-en" \
                   "the_silver_searcher"

# Scripts
load_package "nvm" \
  && command_exists "nvm" \
  && package_group "yarn" \
                   "yarn" \
  && npm_group "npm-packages" \
               "jshint"o

# Social
load_package "skype"
load_package "slack"

# Utility
load_package "qbittorrent"    # A torrent client
load_package "deadbeef"       # An audio player
load_package "mpv"            # A video player



exit_header
