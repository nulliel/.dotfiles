#!/usr/bin/env bash

subheader "google-chrome"

#-- Check for existing installation ----------------------------------------------------------------
if command_exists google-chrome; then
  skip "Installing google-chrome..."
  exit_subheader && return
fi

#-- Confirm installation ---------------------------------------------------------------------------
if ! confirm_default "Install google-chrome?"; then
  skip "Installing google-chrome..."
  exit_subheader && return
fi

#-- Add google-chrome repository -------------------------------------------------------------------
log "Adding google-chrome repository..."

if [[ -f /etc/yum.repos.d/google-chrome.repo ]]; then
  skip
else
  local repo_contents="[google-chrome]
name=google-chrome
baseurl=http://dl.google.com/linux/chrome/rpm/stable/x86_64
enabled=1
gpgcheck=1
gpgkey=https://dl.google.com/linux/linux_signing_key.pub
"

  sudo bash -c "echo \"${REPO_CONTENTS}\" > /etc/yum.repos.d/google-chrome.repo"
  pass
fi

#-- Release install --------------------------------------------------------------------------------
if ! is_default; then
  selection "^Which release would you like to install?" \
            "#2" \
            "beta" \
            "stable" \
            "unstable"
else
  set_selection "stable"
fi

case $SELECTED_VALUE in
  "beta")
    package_install google-chrome-beta
    ;;
  "stable")
    package_install google-chrome-stable
    ;;
  "unstable")
    package_install google-chrome-unstable
    ;;
esac

exit_subheader
